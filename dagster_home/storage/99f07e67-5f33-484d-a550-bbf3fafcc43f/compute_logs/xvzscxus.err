2025-11-04 14:05:48 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - 74747 - LOGS_CAPTURED - Started capturing logs in process (pid: 74747).
2025-11-04 14:05:48 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - 74747 - extract_raw_nabca_table_2 - STEP_START - Started execution of step "extract_raw_nabca_table_2".
2025-11-04 14:05:48 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting NABCA extraction for raw_nabca_table_2
2025-11-04 14:05:48 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Section: Current Month Sales, Pages: 5-6
2025-11-04 14:05:48 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Found 13 PDF artifacts to process
2025-11-04 14:05:48 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing artifact: 18b98daf-312f-4557-8e5d-61a31ef67c6b
2025-11-04 14:05:48 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0125.PDF
2025-11-04 14:05:48 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-04 14:05:48 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - PDF has 718 pages, extracting pages 5-6
2025-11-04 14:05:48 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/18b98daf-312f-4557-8e5d-61a31ef67c6b/section.pdf
2025-11-04 14:05:48 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-04 14:05:49 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job started: a32fc8a04b76be0870a309bf620b776183a18e06b0c88c3aa337eb3dc249d5da
2025-11-04 14:05:54 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:05:59 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job completed after 10s
2025-11-04 14:05:59 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieved 3011 blocks from Textract
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 2: 44 rows
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 42 data rows
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Merged table data: 92 total rows
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (92 rows total):
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '% of']... (showing first 3 cells)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', 'Class']... (showing first 3 cells)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '26.15']... (showing first 3 cells)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.03']... (showing first 3 cells)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '55.27']... (showing first 3 cells)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '2.06']... (showing first 3 cells)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '3.92']... (showing first 3 cells)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '12.56']... (showing first 3 cells)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '16.50', '100.00']... (showing first 3 cells)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '59.99']... (showing first 3 cells)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: 5 non-empty cells
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 90
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Table has 12 columns and 90 data rows
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-04 14:06:00 -0500 - dagster - WARNING - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 0 -> 'class' (class)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 1 -> 'pct_total_dist_spirits' (pct_total_dist_spirits)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 2 -> 'pct_of_class' (pct_of_class)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 3 -> 'total_cases' (total_cases)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 4 -> 'bottle_1_75l' (bottle_1_75l)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 5 -> 'bottle_1_0l' (bottle_1_0l)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 6 -> 'bottle_750ml' (bottle_750ml)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 7 -> 'bottle_750ml_traveler' (bottle_750ml_traveler)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 8 -> 'bottle_375ml' (bottle_375ml)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 9 -> 'bottle_200ml' (bottle_200ml)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 10 -> 'bottle_100ml' (bottle_100ml)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 11 -> 'bottle_50ml' (bottle_50ml)
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š Column Mapping Complete: 12 of 12 columns mapped
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Mapping: {0: 'class', 1: 'pct_total_dist_spirits', 2: 'pct_of_class', 3: 'total_cases', 4: 'bottle_1_75l', 5: 'bottle_1_0l', 6: 'bottle_750ml', 7: 'bottle_750ml_traveler', 8: 'bottle_375ml', 9: 'bottle_200ml', 10: 'bottle_100ml', 11: 'bottle_50ml'}
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracted 90 valid records
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“… Parsed date from '631_9L_0125.PDF': January 2025
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracted 90 records from artifact 18b98daf-312f-4557-8e5d-61a31ef67c6b
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing artifact: 026b4328-d71e-4793-9ee6-1d12af9a43a1
2025-11-04 14:06:00 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0225.PDF
2025-11-04 14:06:01 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-04 14:06:01 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - PDF has 724 pages, extracting pages 5-6
2025-11-04 14:06:01 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/026b4328-d71e-4793-9ee6-1d12af9a43a1/section.pdf
2025-11-04 14:06:01 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-04 14:06:01 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job started: d1b80a733e0d3b7439fd26386f3cf1d7e7634941a847f3021216f0dfc2c73867
2025-11-04 14:06:06 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:06:11 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job completed after 10s
2025-11-04 14:06:11 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieved 3000 blocks from Textract
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 2: 44 rows
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 42 data rows
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Merged table data: 92 total rows
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (92 rows total):
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '']... (showing first 3 cells)
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', '% of Class']... (showing first 3 cells)
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '35.36']... (showing first 3 cells)
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.02']... (showing first 3 cells)
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '47.45']... (showing first 3 cells)
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '1.54']... (showing first 3 cells)
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '3.51']... (showing first 3 cells)
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '12.13']... (showing first 3 cells)
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '18.62', '100.00']... (showing first 3 cells)
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '60.37']... (showing first 3 cells)
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: 3 non-empty cells
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 90
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Table has 12 columns and 90 data rows
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-04 14:06:12 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Failed to process artifact 026b4328-d71e-4793-9ee6-1d12af9a43a1: name 'SequenceMatcher' is not defined
2025-11-04 14:06:12 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Traceback (most recent call last):
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 216, in extract_raw_nabca_table_2
    records = extract_nabca_table_data(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 502, in extract_nabca_table_data
    score1 = similarity(header.lower(), field["name"].lower())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 542, in similarity
    return SequenceMatcher(None, a, b).ratio()
           ^^^^^^^^^^^^^^^
NameError: name 'SequenceMatcher' is not defined

2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing artifact: 0a7f9f31-17c6-42ef-bd71-4a9a6706a88b
2025-11-04 14:06:12 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0325.PDF
2025-11-04 14:06:13 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-04 14:06:13 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - PDF has 732 pages, extracting pages 5-6
2025-11-04 14:06:13 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/0a7f9f31-17c6-42ef-bd71-4a9a6706a88b/section.pdf
2025-11-04 14:06:13 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-04 14:06:13 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job started: da6e7f4a48ae61133bd6f4852c7bcb3c94746b8d2c0605f4b92e27b27f22a46d
2025-11-04 14:06:18 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job completed after 10s
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieved 3003 blocks from Textract
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 2: 44 rows
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 42 data rows
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Merged table data: 92 total rows
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (92 rows total):
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '% of']... (showing first 3 cells)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', 'Class']... (showing first 3 cells)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '25.89']... (showing first 3 cells)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.04']... (showing first 3 cells)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '54.72']... (showing first 3 cells)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '1.79']... (showing first 3 cells)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '3.79']... (showing first 3 cells)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '13.78']... (showing first 3 cells)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '15.62', '100.00']... (showing first 3 cells)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '60.06']... (showing first 3 cells)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: 5 non-empty cells
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 90
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Table has 12 columns and 90 data rows
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-04 14:06:24 -0500 - dagster - WARNING - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 0 -> 'class' (class)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 1 -> 'pct_total_dist_spirits' (pct_total_dist_spirits)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 2 -> 'pct_of_class' (pct_of_class)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 3 -> 'total_cases' (total_cases)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 4 -> 'bottle_1_75l' (bottle_1_75l)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 5 -> 'bottle_1_0l' (bottle_1_0l)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 6 -> 'bottle_750ml' (bottle_750ml)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 7 -> 'bottle_750ml_traveler' (bottle_750ml_traveler)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 8 -> 'bottle_375ml' (bottle_375ml)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 9 -> 'bottle_200ml' (bottle_200ml)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 10 -> 'bottle_100ml' (bottle_100ml)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 11 -> 'bottle_50ml' (bottle_50ml)
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š Column Mapping Complete: 12 of 12 columns mapped
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Mapping: {0: 'class', 1: 'pct_total_dist_spirits', 2: 'pct_of_class', 3: 'total_cases', 4: 'bottle_1_75l', 5: 'bottle_1_0l', 6: 'bottle_750ml', 7: 'bottle_750ml_traveler', 8: 'bottle_375ml', 9: 'bottle_200ml', 10: 'bottle_100ml', 11: 'bottle_50ml'}
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracted 90 valid records
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“… Parsed date from '631_9L_0325.PDF': March 2025
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracted 90 records from artifact 0a7f9f31-17c6-42ef-bd71-4a9a6706a88b
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing artifact: de52568c-a384-42be-8231-7fe698c6a046
2025-11-04 14:06:24 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0425.PDF
2025-11-04 14:06:25 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-04 14:06:25 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - PDF has 740 pages, extracting pages 5-6
2025-11-04 14:06:25 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/de52568c-a384-42be-8231-7fe698c6a046/section.pdf
2025-11-04 14:06:25 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-04 14:06:25 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job started: 4f0f668f9015e91dc39cd91e18d46998ffb254d84d69320ca9087b2c193d233b
2025-11-04 14:06:30 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:06:35 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job completed after 10s
2025-11-04 14:06:35 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieved 2999 blocks from Textract
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 2: 44 rows
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 42 data rows
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Merged table data: 92 total rows
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (92 rows total):
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '% of']... (showing first 3 cells)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', 'Class']... (showing first 3 cells)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '25.76']... (showing first 3 cells)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.03']... (showing first 3 cells)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '54.69']... (showing first 3 cells)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '1.79']... (showing first 3 cells)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '3.88']... (showing first 3 cells)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '13.85']... (showing first 3 cells)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '15.16', '100.00']... (showing first 3 cells)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '61.18']... (showing first 3 cells)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: 5 non-empty cells
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 90
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Table has 12 columns and 90 data rows
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-04 14:06:36 -0500 - dagster - WARNING - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 0 -> 'class' (class)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 1 -> 'pct_total_dist_spirits' (pct_total_dist_spirits)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 2 -> 'pct_of_class' (pct_of_class)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 3 -> 'total_cases' (total_cases)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 4 -> 'bottle_1_75l' (bottle_1_75l)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 5 -> 'bottle_1_0l' (bottle_1_0l)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 6 -> 'bottle_750ml' (bottle_750ml)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 7 -> 'bottle_750ml_traveler' (bottle_750ml_traveler)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 8 -> 'bottle_375ml' (bottle_375ml)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 9 -> 'bottle_200ml' (bottle_200ml)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 10 -> 'bottle_100ml' (bottle_100ml)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 11 -> 'bottle_50ml' (bottle_50ml)
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š Column Mapping Complete: 12 of 12 columns mapped
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Mapping: {0: 'class', 1: 'pct_total_dist_spirits', 2: 'pct_of_class', 3: 'total_cases', 4: 'bottle_1_75l', 5: 'bottle_1_0l', 6: 'bottle_750ml', 7: 'bottle_750ml_traveler', 8: 'bottle_375ml', 9: 'bottle_200ml', 10: 'bottle_100ml', 11: 'bottle_50ml'}
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracted 90 valid records
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“… Parsed date from '631_9L_0425.PDF': April 2025
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracted 90 records from artifact de52568c-a384-42be-8231-7fe698c6a046
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing artifact: bfaec311-e14e-406b-a80b-f27df5079652
2025-11-04 14:06:36 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0525.PDF
2025-11-04 14:06:37 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-04 14:06:37 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - PDF has 752 pages, extracting pages 5-6
2025-11-04 14:06:37 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/bfaec311-e14e-406b-a80b-f27df5079652/section.pdf
2025-11-04 14:06:37 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-04 14:06:37 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job started: b643e98748ae7bbadc57445a14af9df01faf3522e69128fed4ad21d497eebbd0
2025-11-04 14:06:42 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:06:48 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 10s)
2025-11-04 14:06:53 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job completed after 15s
2025-11-04 14:06:53 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-04 14:06:53 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieved 2993 blocks from Textract
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 2: 44 rows
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 42 data rows
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Merged table data: 92 total rows
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (92 rows total):
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '']... (showing first 3 cells)
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', '% of Class']... (showing first 3 cells)
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '25.47']... (showing first 3 cells)
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.04']... (showing first 3 cells)
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '55.12']... (showing first 3 cells)
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '1.75']... (showing first 3 cells)
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '3.87']... (showing first 3 cells)
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '13.75']... (showing first 3 cells)
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '14.67', '100.00']... (showing first 3 cells)
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '61.04']... (showing first 3 cells)
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: 3 non-empty cells
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 90
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Table has 12 columns and 90 data rows
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-04 14:06:54 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Failed to process artifact bfaec311-e14e-406b-a80b-f27df5079652: name 'SequenceMatcher' is not defined
2025-11-04 14:06:54 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Traceback (most recent call last):
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 216, in extract_raw_nabca_table_2
    records = extract_nabca_table_data(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 502, in extract_nabca_table_data
    score1 = similarity(header.lower(), field["name"].lower())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 542, in similarity
    return SequenceMatcher(None, a, b).ratio()
           ^^^^^^^^^^^^^^^
NameError: name 'SequenceMatcher' is not defined

2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing artifact: d96cc16b-2f4f-4bfd-819b-9319aede5b5a
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0625.PDF
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - PDF has 756 pages, extracting pages 5-6
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/d96cc16b-2f4f-4bfd-819b-9319aede5b5a/section.pdf
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-04 14:06:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job started: 47a22ea649312d7dc01bd3f7f4a58aa7760246745bb62d3bc5fecdb51974f75d
2025-11-04 14:07:00 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:07:05 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job completed after 10s
2025-11-04 14:07:05 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieved 2995 blocks from Textract
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 2: 44 rows
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 42 data rows
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Merged table data: 92 total rows
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (92 rows total):
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '% of']... (showing first 3 cells)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', 'Class']... (showing first 3 cells)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '25.29']... (showing first 3 cells)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.03']... (showing first 3 cells)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '55.61']... (showing first 3 cells)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '1.81']... (showing first 3 cells)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '3.74']... (showing first 3 cells)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '13.51']... (showing first 3 cells)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '14.18', '100.00']... (showing first 3 cells)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '60.34']... (showing first 3 cells)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: 5 non-empty cells
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 90
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Table has 12 columns and 90 data rows
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-04 14:07:06 -0500 - dagster - WARNING - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 0 -> 'class' (class)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 1 -> 'pct_total_dist_spirits' (pct_total_dist_spirits)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 2 -> 'pct_of_class' (pct_of_class)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 3 -> 'total_cases' (total_cases)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 4 -> 'bottle_1_75l' (bottle_1_75l)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 5 -> 'bottle_1_0l' (bottle_1_0l)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 6 -> 'bottle_750ml' (bottle_750ml)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 7 -> 'bottle_750ml_traveler' (bottle_750ml_traveler)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 8 -> 'bottle_375ml' (bottle_375ml)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 9 -> 'bottle_200ml' (bottle_200ml)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 10 -> 'bottle_100ml' (bottle_100ml)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 11 -> 'bottle_50ml' (bottle_50ml)
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š Column Mapping Complete: 12 of 12 columns mapped
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Mapping: {0: 'class', 1: 'pct_total_dist_spirits', 2: 'pct_of_class', 3: 'total_cases', 4: 'bottle_1_75l', 5: 'bottle_1_0l', 6: 'bottle_750ml', 7: 'bottle_750ml_traveler', 8: 'bottle_375ml', 9: 'bottle_200ml', 10: 'bottle_100ml', 11: 'bottle_50ml'}
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracted 90 valid records
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“… Parsed date from '631_9L_0625.PDF': June 2025
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracted 90 records from artifact d96cc16b-2f4f-4bfd-819b-9319aede5b5a
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing artifact: 5062bfca-0f07-456f-8f8a-08b07c8549fa
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0724.PDF
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - PDF has 726 pages, extracting pages 5-6
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/5062bfca-0f07-456f-8f8a-08b07c8549fa/section.pdf
2025-11-04 14:07:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-04 14:07:07 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job started: a4136545c0b3553a80dd0fae3cf6bae1c20033c9efe346d5c369ca949c97255b
2025-11-04 14:07:12 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:07:17 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job completed after 10s
2025-11-04 14:07:17 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieved 2942 blocks from Textract
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 2: 43 rows
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 41 data rows
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Merged table data: 91 total rows
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (91 rows total):
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '% of']... (showing first 3 cells)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', 'Class']... (showing first 3 cells)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '26.53']... (showing first 3 cells)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.03']... (showing first 3 cells)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '55.07']... (showing first 3 cells)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '2.29']... (showing first 3 cells)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '3.74']... (showing first 3 cells)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '12.34']... (showing first 3 cells)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '13.96', '100.00']... (showing first 3 cells)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '60.58']... (showing first 3 cells)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: 5 non-empty cells
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 89
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Table has 12 columns and 89 data rows
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-04 14:07:18 -0500 - dagster - WARNING - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 0 -> 'class' (class)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 1 -> 'pct_total_dist_spirits' (pct_total_dist_spirits)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 2 -> 'pct_of_class' (pct_of_class)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 3 -> 'total_cases' (total_cases)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 4 -> 'bottle_1_75l' (bottle_1_75l)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 5 -> 'bottle_1_0l' (bottle_1_0l)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 6 -> 'bottle_750ml' (bottle_750ml)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 7 -> 'bottle_750ml_traveler' (bottle_750ml_traveler)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 8 -> 'bottle_375ml' (bottle_375ml)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 9 -> 'bottle_200ml' (bottle_200ml)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 10 -> 'bottle_100ml' (bottle_100ml)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 11 -> 'bottle_50ml' (bottle_50ml)
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š Column Mapping Complete: 12 of 12 columns mapped
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Mapping: {0: 'class', 1: 'pct_total_dist_spirits', 2: 'pct_of_class', 3: 'total_cases', 4: 'bottle_1_75l', 5: 'bottle_1_0l', 6: 'bottle_750ml', 7: 'bottle_750ml_traveler', 8: 'bottle_375ml', 9: 'bottle_200ml', 10: 'bottle_100ml', 11: 'bottle_50ml'}
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracted 89 valid records
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“… Parsed date from '631_9L_0724.PDF': July 2024
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracted 89 records from artifact 5062bfca-0f07-456f-8f8a-08b07c8549fa
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing artifact: 5c21d408-8558-46af-a313-d0c34ea32bfc
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0725.PDF
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - PDF has 762 pages, extracting pages 5-6
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/5c21d408-8558-46af-a313-d0c34ea32bfc/section.pdf
2025-11-04 14:07:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-04 14:07:19 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job started: ee4cfa7968b5107d5bd46733dbe170fa066d6a756d550474745af2a5f3a408dc
2025-11-04 14:07:24 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:07:29 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job completed after 10s
2025-11-04 14:07:29 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieved 3032 blocks from Textract
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 2: 44 rows
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 42 data rows
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Merged table data: 92 total rows
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (92 rows total):
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '% of']... (showing first 3 cells)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', 'Class']... (showing first 3 cells)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '25.81']... (showing first 3 cells)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.03']... (showing first 3 cells)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '54.95']... (showing first 3 cells)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '1.78']... (showing first 3 cells)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '3.85']... (showing first 3 cells)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '13.57']... (showing first 3 cells)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '15.02', '100.00']... (showing first 3 cells)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '60.66']... (showing first 3 cells)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: 5 non-empty cells
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 90
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Table has 12 columns and 90 data rows
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-04 14:07:30 -0500 - dagster - WARNING - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 0 -> 'class' (class)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 1 -> 'pct_total_dist_spirits' (pct_total_dist_spirits)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 2 -> 'pct_of_class' (pct_of_class)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 3 -> 'total_cases' (total_cases)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 4 -> 'bottle_1_75l' (bottle_1_75l)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 5 -> 'bottle_1_0l' (bottle_1_0l)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 6 -> 'bottle_750ml' (bottle_750ml)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 7 -> 'bottle_750ml_traveler' (bottle_750ml_traveler)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 8 -> 'bottle_375ml' (bottle_375ml)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 9 -> 'bottle_200ml' (bottle_200ml)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 10 -> 'bottle_100ml' (bottle_100ml)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Positional mapping: column 11 -> 'bottle_50ml' (bottle_50ml)
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š Column Mapping Complete: 12 of 12 columns mapped
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Mapping: {0: 'class', 1: 'pct_total_dist_spirits', 2: 'pct_of_class', 3: 'total_cases', 4: 'bottle_1_75l', 5: 'bottle_1_0l', 6: 'bottle_750ml', 7: 'bottle_750ml_traveler', 8: 'bottle_375ml', 9: 'bottle_200ml', 10: 'bottle_100ml', 11: 'bottle_50ml'}
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracted 90 valid records
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“… Parsed date from '631_9L_0725.PDF': July 2025
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracted 90 records from artifact 5c21d408-8558-46af-a313-d0c34ea32bfc
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing artifact: 3b066d2f-b4ba-48a9-8b2a-4abfc6a39184
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0824.PDF
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - PDF has 736 pages, extracting pages 5-6
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/3b066d2f-b4ba-48a9-8b2a-4abfc6a39184/section.pdf
2025-11-04 14:07:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-04 14:07:31 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job started: 58965aebfb0624a72f5cf19888099b663363636b6c1803d94273ae5aace73f15
2025-11-04 14:07:36 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job completed after 10s
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieved 2944 blocks from Textract
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 2: 43 rows
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 41 data rows
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Merged table data: 91 total rows
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (91 rows total):
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '']... (showing first 3 cells)
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', '% of Class']... (showing first 3 cells)
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '25.65']... (showing first 3 cells)
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.02']... (showing first 3 cells)
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '55.46']... (showing first 3 cells)
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '2.41']... (showing first 3 cells)
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '3.92']... (showing first 3 cells)
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '12.53']... (showing first 3 cells)
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '14.68', '100.00']... (showing first 3 cells)
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '63.44']... (showing first 3 cells)
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: 3 non-empty cells
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-04 14:07:41 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 89
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Table has 12 columns and 89 data rows
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-04 14:07:42 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Failed to process artifact 3b066d2f-b4ba-48a9-8b2a-4abfc6a39184: name 'SequenceMatcher' is not defined
2025-11-04 14:07:42 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Traceback (most recent call last):
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 216, in extract_raw_nabca_table_2
    records = extract_nabca_table_data(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 502, in extract_nabca_table_data
    score1 = similarity(header.lower(), field["name"].lower())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 542, in similarity
    return SequenceMatcher(None, a, b).ratio()
           ^^^^^^^^^^^^^^^
NameError: name 'SequenceMatcher' is not defined

2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing artifact: 0f2c48bb-830e-4bf4-94fc-0fde43277c08
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0924.PDF
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - PDF has 740 pages, extracting pages 5-6
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/0f2c48bb-830e-4bf4-94fc-0fde43277c08/section.pdf
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-04 14:07:42 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job started: d2dfafe4887255995718c810f05ad5a2a92ec41ad31450fea30873c036be13e4
2025-11-04 14:07:48 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:07:53 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job completed after 10s
2025-11-04 14:07:53 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-04 14:07:53 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieved 2954 blocks from Textract
2025-11-04 14:07:53 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-04 14:07:53 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-04 14:07:53 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-04 14:07:53 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 2: 43 rows
2025-11-04 14:07:53 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 41 data rows
2025-11-04 14:07:53 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Merged table data: 91 total rows
2025-11-04 14:07:53 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (91 rows total):
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '']... (showing first 3 cells)
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', '% of Class']... (showing first 3 cells)
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '25.60']... (showing first 3 cells)
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.02']... (showing first 3 cells)
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '55.26']... (showing first 3 cells)
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '2.44']... (showing first 3 cells)
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '3.81']... (showing first 3 cells)
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '12.88']... (showing first 3 cells)
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '15.10', '100.00']... (showing first 3 cells)
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '60.04']... (showing first 3 cells)
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: 3 non-empty cells
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 89
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Table has 12 columns and 89 data rows
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-04 14:07:54 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Failed to process artifact 0f2c48bb-830e-4bf4-94fc-0fde43277c08: name 'SequenceMatcher' is not defined
2025-11-04 14:07:54 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Traceback (most recent call last):
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 216, in extract_raw_nabca_table_2
    records = extract_nabca_table_data(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 502, in extract_nabca_table_data
    score1 = similarity(header.lower(), field["name"].lower())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 542, in similarity
    return SequenceMatcher(None, a, b).ratio()
           ^^^^^^^^^^^^^^^
NameError: name 'SequenceMatcher' is not defined

2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing artifact: 386391b7-c87b-415b-a33e-0b3f30ff10c6
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_1024.PDF
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - PDF has 752 pages, extracting pages 5-6
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/386391b7-c87b-415b-a33e-0b3f30ff10c6/section.pdf
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-04 14:07:54 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job started: e454a99a217b2f5b0ab8a8c4dd7b34aa9b405f6b4d10e5cc7413f21dab429b8f
2025-11-04 14:08:00 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:08:05 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job completed after 10s
2025-11-04 14:08:05 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-04 14:08:05 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieved 2996 blocks from Textract
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 2: 44 rows
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 42 data rows
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Merged table data: 92 total rows
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (92 rows total):
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '']... (showing first 3 cells)
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', '% of Class']... (showing first 3 cells)
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '25.56']... (showing first 3 cells)
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.02']... (showing first 3 cells)
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '55.12']... (showing first 3 cells)
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '2.34']... (showing first 3 cells)
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '3.96']... (showing first 3 cells)
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '13.00']... (showing first 3 cells)
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '15.66', '100.00']... (showing first 3 cells)
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '60.94']... (showing first 3 cells)
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: 3 non-empty cells
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 90
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Table has 12 columns and 90 data rows
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-04 14:08:06 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Failed to process artifact 386391b7-c87b-415b-a33e-0b3f30ff10c6: name 'SequenceMatcher' is not defined
2025-11-04 14:08:06 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Traceback (most recent call last):
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 216, in extract_raw_nabca_table_2
    records = extract_nabca_table_data(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 502, in extract_nabca_table_data
    score1 = similarity(header.lower(), field["name"].lower())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 542, in similarity
    return SequenceMatcher(None, a, b).ratio()
           ^^^^^^^^^^^^^^^
NameError: name 'SequenceMatcher' is not defined

2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing artifact: 015aad82-ac64-4ab3-bb60-134d8723fea5
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_1124.PDF
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - PDF has 758 pages, extracting pages 5-6
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/015aad82-ac64-4ab3-bb60-134d8723fea5/section.pdf
2025-11-04 14:08:06 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-04 14:08:07 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job started: 87fdb97859db794d1a2d26a20b21b13e08d3211381c339392bb7d89bbfd1f86d
2025-11-04 14:08:12 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:08:17 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job completed after 10s
2025-11-04 14:08:17 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieved 3010 blocks from Textract
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 2: 44 rows
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 42 data rows
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Merged table data: 92 total rows
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (92 rows total):
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '']... (showing first 3 cells)
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', '% of Class']... (showing first 3 cells)
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '24.92']... (showing first 3 cells)
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.02']... (showing first 3 cells)
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '54.37']... (showing first 3 cells)
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '2.35']... (showing first 3 cells)
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '4.21']... (showing first 3 cells)
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '14.13']... (showing first 3 cells)
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '16.51', '100.00']... (showing first 3 cells)
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '62.87']... (showing first 3 cells)
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: 3 non-empty cells
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 90
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Table has 12 columns and 90 data rows
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-04 14:08:18 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Failed to process artifact 015aad82-ac64-4ab3-bb60-134d8723fea5: name 'SequenceMatcher' is not defined
2025-11-04 14:08:18 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Traceback (most recent call last):
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 216, in extract_raw_nabca_table_2
    records = extract_nabca_table_data(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 502, in extract_nabca_table_data
    score1 = similarity(header.lower(), field["name"].lower())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 542, in similarity
    return SequenceMatcher(None, a, b).ratio()
           ^^^^^^^^^^^^^^^
NameError: name 'SequenceMatcher' is not defined

2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing artifact: fb4f08e3-1f73-45e0-9e53-761b167d8555
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_1224.PDF
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - PDF has 766 pages, extracting pages 5-6
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/fb4f08e3-1f73-45e0-9e53-761b167d8555/section.pdf
2025-11-04 14:08:18 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-04 14:08:19 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job started: ae54ebdc4a315c10fcf6a5b39e437f04e1617fedfee7bd9e6e5b92799039311e
2025-11-04 14:08:24 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:08:29 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract job completed after 10s
2025-11-04 14:08:29 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Retrieved 3017 blocks from Textract
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Table 2: 44 rows
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 42 data rows
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Merged table data: 92 total rows
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (92 rows total):
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '']... (showing first 3 cells)
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', '% of Class']... (showing first 3 cells)
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '24.39']... (showing first 3 cells)
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.03']... (showing first 3 cells)
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '53.45']... (showing first 3 cells)
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '2.68']... (showing first 3 cells)
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '4.49']... (showing first 3 cells)
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '14.95']... (showing first 3 cells)
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '17.27', '100.00']... (showing first 3 cells)
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '60.61']... (showing first 3 cells)
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 0: 3 non-empty cells
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 90
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Table has 12 columns and 90 data rows
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', '% of Class', 'Total Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-04 14:08:30 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Failed to process artifact fb4f08e3-1f73-45e0-9e53-761b167d8555: name 'SequenceMatcher' is not defined
2025-11-04 14:08:30 -0500 - dagster - ERROR - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Traceback (most recent call last):
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 216, in extract_raw_nabca_table_2
    records = extract_nabca_table_data(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 502, in extract_nabca_table_data
    score1 = similarity(header.lower(), field["name"].lower())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/pipelines/raw_nabca_table_2_v1.py", line 542, in similarity
    return SequenceMatcher(None, a, b).ratio()
           ^^^^^^^^^^^^^^^
NameError: name 'SequenceMatcher' is not defined

2025-11-04 14:08:30 -0500 - dagster - INFO - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - NABCA extraction complete: 539 records from 13 artifacts, 7 failed (98.7% success rate)
2025-11-04 14:08:30 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - 74747 - extract_raw_nabca_table_2 - STEP_OUTPUT - Yielded output "result" of type "Dict[String,Any]". (Type check passed).
2025-11-04 14:08:30 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - extract_raw_nabca_table_2 - Writing file at: /Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/storage/extract_raw_nabca_table_2 using PickledObjectFilesystemIOManager...
2025-11-04 14:08:30 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - 74747 - extract_raw_nabca_table_2 - ASSET_MATERIALIZATION - Materialized value extract_raw_nabca_table_2.
2025-11-04 14:08:30 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - 74747 - extract_raw_nabca_table_2 - HANDLED_OUTPUT - Handled output "result" using IO manager "io_manager"
2025-11-04 14:08:30 -0500 - dagster - DEBUG - __ASSET_JOB - 99f07e67-5f33-484d-a550-bbf3fafcc43f - 74747 - extract_raw_nabca_table_2 - STEP_SUCCESS - Finished execution of step "extract_raw_nabca_table_2" in 2m42s.
