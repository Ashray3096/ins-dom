2025-11-03 23:59:13 -0500 - dagster - DEBUG - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - 69817 - LOGS_CAPTURED - Started capturing logs in process (pid: 69817).
2025-11-03 23:59:13 -0500 - dagster - DEBUG - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - 69817 - extract_raw_nabca_table_2 - STEP_START - Started execution of step "extract_raw_nabca_table_2".
2025-11-03 23:59:13 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Starting NABCA extraction for raw_nabca_table_2
2025-11-03 23:59:13 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Section: Current Month Sales, Pages: 5-6
2025-11-03 23:59:14 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Found 1 PDF artifacts to process
2025-11-03 23:59:14 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Processing artifact: 3e73a850-bfe5-4245-8a13-b20d1c89e5c7
2025-11-03 23:59:14 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0125.PDF
2025-11-03 23:59:14 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Extracting pages 5-6...
2025-11-03 23:59:14 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - PDF has 718 pages, extracting pages 5-6
2025-11-03 23:59:14 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/3e73a850-bfe5-4245-8a13-b20d1c89e5c7/section.pdf
2025-11-03 23:59:14 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Starting Textract async analysis...
2025-11-03 23:59:15 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Textract job started: 499a9a91ff9d7811d165b67543720707c3478e4ffcc365b6fc550a4c14080d07
2025-11-03 23:59:20 -0500 - dagster - DEBUG - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-03 23:59:25 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Textract job completed after 10s
2025-11-03 23:59:25 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Retrieving all Textract blocks...
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Retrieved 3011 blocks from Textract
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Textract complete: 2 tables detected
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Processing 2 tables...
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Table 1: 50 rows
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Table 2: 44 rows
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -     Skipping 2 header rows, merging 42 data rows
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Merged table data: 92 total rows
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - ðŸ“Š RAW TABLE DATA (92 rows total):
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 0: ['', '%Total', '% of']... (showing first 3 cells)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 1: ['CLASS', 'Dist. Spirits', 'Class']... (showing first 3 cells)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 2: ['DOM WHSKY-BLND', '', '26.15']... (showing first 3 cells)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 3: ['DOM WHSKY-SNGL MALT', '', '.03']... (showing first 3 cells)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 4: ['DOM WHSKY-STRT-BRBN/TN', '', '55.27']... (showing first 3 cells)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 5: ['DOM WHSKY-STRT-OTH', '', '2.06']... (showing first 3 cells)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 6: ['DOM WHSKY-STRT-RYE', '', '3.92']... (showing first 3 cells)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 7: ['DOM WHSKY-STRT-SM BTCH', '', '12.56']... (showing first 3 cells)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 8: ['TOTAL DOM WHSKY', '16.50', '100.00']... (showing first 3 cells)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 9: ['SCOTCH-BLND-FRGN BTLD', '', '59.99']... (showing first 3 cells)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 0: 5 non-empty cells
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 1: 12 non-empty cells
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 2: 11 non-empty cells
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 3: 4 non-empty cells
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -   Row 4: 11 non-empty cells
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âœ… Detected header row at index 1 (has 12 non-empty cells)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - ðŸ“‹ Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - ðŸ“ˆ Data rows: 90
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Table has 12 columns and 90 data rows
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - ðŸ“‹ Textract Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - ðŸŽ¯ Semantic Fields: ['class (class)', 'pct_total_dist_spirits (pct_total_dist_spirits)', 'pct_of_class (pct_of_class)', 'total_cases (total_cases)', 'bottle_1_75l (bottle_1_75l)', 'bottle_1_0l (bottle_1_0l)', 'bottle_750ml (bottle_750ml)', 'bottle_750ml_traveler (bottle_750ml_traveler)', 'bottle_375ml (bottle_375ml)', 'bottle_200ml (bottle_200ml)', 'bottle_100ml (bottle_100ml)', 'bottle_50ml (bottle_50ml)']
2025-11-03 23:59:26 -0500 - dagster - WARNING - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 -     Headers: ['CLASS', 'Dist. Spirits', 'Class', 'Cases', '1.75 L', '1.0 L', '750 ml', '750 ml Traveler', '375 ml', '200 ml', '100 ml', '50 ml']
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âœ… Positional mapping: column 0 -> 'class' (class)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âœ… Positional mapping: column 1 -> 'pct_total_dist_spirits' (pct_total_dist_spirits)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âœ… Positional mapping: column 2 -> 'pct_of_class' (pct_of_class)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âœ… Positional mapping: column 3 -> 'total_cases' (total_cases)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âœ… Positional mapping: column 4 -> 'bottle_1_75l' (bottle_1_75l)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âœ… Positional mapping: column 5 -> 'bottle_1_0l' (bottle_1_0l)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âœ… Positional mapping: column 6 -> 'bottle_750ml' (bottle_750ml)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âœ… Positional mapping: column 7 -> 'bottle_750ml_traveler' (bottle_750ml_traveler)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âœ… Positional mapping: column 8 -> 'bottle_375ml' (bottle_375ml)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âœ… Positional mapping: column 9 -> 'bottle_200ml' (bottle_200ml)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âœ… Positional mapping: column 10 -> 'bottle_100ml' (bottle_100ml)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - âœ… Positional mapping: column 11 -> 'bottle_50ml' (bottle_50ml)
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - ðŸ“Š Column Mapping Complete: 12 of 12 columns mapped
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Mapping: {0: 'class', 1: 'pct_total_dist_spirits', 2: 'pct_of_class', 3: 'total_cases', 4: 'bottle_1_75l', 5: 'bottle_1_0l', 6: 'bottle_750ml', 7: 'bottle_750ml_traveler', 8: 'bottle_375ml', 9: 'bottle_200ml', 10: 'bottle_100ml', 11: 'bottle_50ml'}
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Extracted 90 valid records
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Extracted 90 records from artifact 3e73a850-bfe5-4245-8a13-b20d1c89e5c7
2025-11-03 23:59:26 -0500 - dagster - INFO - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - NABCA extraction complete: 90 records from 1 artifacts, 0 failed (100.0% success rate)
2025-11-03 23:59:26 -0500 - dagster - DEBUG - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - 69817 - extract_raw_nabca_table_2 - STEP_OUTPUT - Yielded output "result" of type "Dict[String,Any]". (Type check passed).
2025-11-03 23:59:26 -0500 - dagster - DEBUG - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - extract_raw_nabca_table_2 - Writing file at: /Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/storage/extract_raw_nabca_table_2 using PickledObjectFilesystemIOManager...
2025-11-03 23:59:26 -0500 - dagster - DEBUG - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - 69817 - extract_raw_nabca_table_2 - ASSET_MATERIALIZATION - Materialized value extract_raw_nabca_table_2.
2025-11-03 23:59:26 -0500 - dagster - DEBUG - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - 69817 - extract_raw_nabca_table_2 - HANDLED_OUTPUT - Handled output "result" using IO manager "io_manager"
2025-11-03 23:59:26 -0500 - dagster - DEBUG - __ASSET_JOB - 709b9c6a-c0aa-4c85-85b6-c38e26224aa9 - 69817 - extract_raw_nabca_table_2 - STEP_SUCCESS - Finished execution of step "extract_raw_nabca_table_2" in 12.94s.
