2025-11-04 13:58:13 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - 74639 - LOGS_CAPTURED - Started capturing logs in process (pid: 74639).
2025-11-04 13:58:13 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - 74639 - extract_raw_nabca_table_1 - STEP_START - Started execution of step "extract_raw_nabca_table_1".
2025-11-04 13:58:13 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting NABCA extraction for raw_nabca_table_1
2025-11-04 13:58:13 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Section: Brand Leaders, Pages: 3-4
2025-11-04 13:58:13 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Found 13 PDF artifacts to process
2025-11-04 13:58:13 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing artifact: 18b98daf-312f-4557-8e5d-61a31ef67c6b
2025-11-04 13:58:13 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0125.PDF
2025-11-04 13:58:14 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracting pages 3-4...
2025-11-04 13:58:14 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - PDF has 718 pages, extracting pages 3-4
2025-11-04 13:58:14 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/18b98daf-312f-4557-8e5d-61a31ef67c6b/section.pdf
2025-11-04 13:58:14 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting Textract async analysis...
2025-11-04 13:58:14 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job started: 1687ba843209bcafe22b0ca728ef4b5e374c3522543c41c7486bfc513e2edfc3
2025-11-04 13:58:19 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 13:58:24 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 10s)
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job completed after 15s
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieving all Textract blocks...
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieved 3102 blocks from Textract
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract complete: 2 tables detected
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing 2 tables...
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 1: 53 rows
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 2: 53 rows
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Skipping 3 header rows, merging 50 data rows
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Merged table data: 103 total rows
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š RAW TABLE DATA (103 rows total):
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: ['ALL CONTROL STATES-JANUARY', '2025', '']... (showing first 3 cells)
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: ['', '', '']... (showing first 3 cells)
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: ['BRAND', 'Type', 'Rank']... (showing first 3 cells)
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: ['TITO HANDMADE', 'VODKA-CLASSIC-DOM', '1']... (showing first 3 cells)
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: ['FIREBALL CINNMN', 'CAN-US BLND-US BTLD', '2']... (showing first 3 cells)
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 5: ['J DNL BLACK LBL', 'DOM WHSKY-STRT-BRBN/TN', '3']... (showing first 3 cells)
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 6: ['CPTMRG ORG SPCD', 'RUM-FLVRD', '4']... (showing first 3 cells)
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 7: ['JIM BEAM', 'DOM WHSKY-STRT-BRBN/TN', '5']... (showing first 3 cells)
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 8: ['PLATINUM 7X', 'VODKA-CLASSIC-DOM', '6']... (showing first 3 cells)
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 9: ['JAMESON', 'IRISH-BLND', '7']... (showing first 3 cells)
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: 2 non-empty cells
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: 6 non-empty cells
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: 9 non-empty cells
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: 9 non-empty cells
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: 9 non-empty cells
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Detected header row at index 2 (has 9 non-empty cells)
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“ˆ Data rows: 100
2025-11-04 13:58:30 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Table has 9 columns and 100 data rows
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Textract Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸŽ¯ Semantic Fields: ['brand (brand)', 'type (type)', 'ytd_rank (ytd_rank)', 'ytd_pct_total (ytd_pct_total)', 'ytd_case_sales (ytd_case_sales)', 'ytd_vs_last_year (ytd_vs_last_year)', 'current_month_case_sales (current_month_case_sales)', 'current_month_vs_last_year (current_month_vs_last_year)', 'l12m_case_sales (l12m_case_sales)']
2025-11-04 13:58:31 -0500 - dagster - WARNING - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 0 -> 'brand' (brand)
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 1 -> 'type' (type)
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 2 -> 'ytd_rank' (ytd_rank)
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 3 -> 'ytd_pct_total' (ytd_pct_total)
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 4 -> 'ytd_case_sales' (ytd_case_sales)
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 5 -> 'ytd_vs_last_year' (ytd_vs_last_year)
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 6 -> 'current_month_case_sales' (current_month_case_sales)
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 7 -> 'current_month_vs_last_year' (current_month_vs_last_year)
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 8 -> 'l12m_case_sales' (l12m_case_sales)
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š Column Mapping Complete: 9 of 9 columns mapped
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Mapping: {0: 'brand', 1: 'type', 2: 'ytd_rank', 3: 'ytd_pct_total', 4: 'ytd_case_sales', 5: 'ytd_vs_last_year', 6: 'current_month_case_sales', 7: 'current_month_vs_last_year', 8: 'l12m_case_sales'}
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 valid records
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“… Parsed date from '631_9L_0125.PDF': January 2025
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 records from artifact 18b98daf-312f-4557-8e5d-61a31ef67c6b
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing artifact: 026b4328-d71e-4793-9ee6-1d12af9a43a1
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0225.PDF
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracting pages 3-4...
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - PDF has 724 pages, extracting pages 3-4
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/026b4328-d71e-4793-9ee6-1d12af9a43a1/section.pdf
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting Textract async analysis...
2025-11-04 13:58:31 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job started: 7588bcdaccffd0ee792ca002609969395581859941d54e9f9ed1b77cf26bc6ed
2025-11-04 13:58:36 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 13:58:42 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job completed after 10s
2025-11-04 13:58:42 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieving all Textract blocks...
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieved 3107 blocks from Textract
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract complete: 2 tables detected
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing 2 tables...
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 1: 53 rows
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 2: 53 rows
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Skipping 3 header rows, merging 50 data rows
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Merged table data: 103 total rows
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š RAW TABLE DATA (103 rows total):
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: ['ALL CONTROL STATES-FEBRUARY', '2025', '']... (showing first 3 cells)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: ['', '', '']... (showing first 3 cells)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: ['BRAND', 'Type', 'Rank']... (showing first 3 cells)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: ['TITO HANDMADE', 'VODKA-CLASSIC-DOM', '1']... (showing first 3 cells)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: ['FIREBALL CINNMN', 'DOM WHSKY-BLND', '2']... (showing first 3 cells)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 5: ['J DNL BLACK LBL', 'DOM WHSKY-STRT-BRBN/TN', '3']... (showing first 3 cells)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 6: ['JIM BEAM', 'DOM WHSKY-STRT-BRBN/TN', '4']... (showing first 3 cells)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 7: ['CPTMRG ORG SPCD', 'RUM-FLVRD', '5']... (showing first 3 cells)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 8: ['PLATINUM 7X', 'VODKA-CLASSIC-DOM', '6']... (showing first 3 cells)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 9: ['JAMESON', 'IRISH-BLND', '7']... (showing first 3 cells)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: 2 non-empty cells
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: 6 non-empty cells
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: 9 non-empty cells
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: 9 non-empty cells
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: 9 non-empty cells
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Detected header row at index 2 (has 9 non-empty cells)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“ˆ Data rows: 100
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Table has 9 columns and 100 data rows
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Textract Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸŽ¯ Semantic Fields: ['brand (brand)', 'type (type)', 'ytd_rank (ytd_rank)', 'ytd_pct_total (ytd_pct_total)', 'ytd_case_sales (ytd_case_sales)', 'ytd_vs_last_year (ytd_vs_last_year)', 'current_month_case_sales (current_month_case_sales)', 'current_month_vs_last_year (current_month_vs_last_year)', 'l12m_case_sales (l12m_case_sales)']
2025-11-04 13:58:43 -0500 - dagster - WARNING - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 0 -> 'brand' (brand)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 1 -> 'type' (type)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 2 -> 'ytd_rank' (ytd_rank)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 3 -> 'ytd_pct_total' (ytd_pct_total)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 4 -> 'ytd_case_sales' (ytd_case_sales)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 5 -> 'ytd_vs_last_year' (ytd_vs_last_year)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 6 -> 'current_month_case_sales' (current_month_case_sales)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 7 -> 'current_month_vs_last_year' (current_month_vs_last_year)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 8 -> 'l12m_case_sales' (l12m_case_sales)
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š Column Mapping Complete: 9 of 9 columns mapped
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Mapping: {0: 'brand', 1: 'type', 2: 'ytd_rank', 3: 'ytd_pct_total', 4: 'ytd_case_sales', 5: 'ytd_vs_last_year', 6: 'current_month_case_sales', 7: 'current_month_vs_last_year', 8: 'l12m_case_sales'}
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 valid records
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“… Parsed date from '631_9L_0225.PDF': February 2025
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 records from artifact 026b4328-d71e-4793-9ee6-1d12af9a43a1
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing artifact: 0a7f9f31-17c6-42ef-bd71-4a9a6706a88b
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0325.PDF
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracting pages 3-4...
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - PDF has 732 pages, extracting pages 3-4
2025-11-04 13:58:43 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/0a7f9f31-17c6-42ef-bd71-4a9a6706a88b/section.pdf
2025-11-04 13:58:44 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting Textract async analysis...
2025-11-04 13:58:44 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job started: 56cd1e67617cce2d4a57c3a617aefe7b00100e3d274255f3c8b00915dd685423
2025-11-04 13:58:49 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 13:58:54 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job completed after 10s
2025-11-04 13:58:54 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieving all Textract blocks...
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieved 3108 blocks from Textract
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract complete: 2 tables detected
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing 2 tables...
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 1: 53 rows
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 2: 53 rows
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Skipping 3 header rows, merging 50 data rows
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Merged table data: 103 total rows
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š RAW TABLE DATA (103 rows total):
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: ['ALL CONTROL STATES-MARCH', '2025', '']... (showing first 3 cells)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: ['', '', '']... (showing first 3 cells)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: ['BRAND', 'Type', 'Rank']... (showing first 3 cells)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: ['TITO HANDMADE', 'VODKA-CLASSIC-DOM', '1']... (showing first 3 cells)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: ['FIREBALL CINNMN', 'CAN-US BLND-US BTLD', '2']... (showing first 3 cells)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 5: ['J DNL BLACK LBL', 'DOM WHSKY-STRT-BRBN/TN', '3']... (showing first 3 cells)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 6: ['CPTMRG ORG SPCD', 'RUM-FLVRD', '4']... (showing first 3 cells)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 7: ['JIM BEAM', 'DOM WHSKY-STRT-BRBN/TN', '5']... (showing first 3 cells)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 8: ['PLATINUM 7X', 'VODKA-CLASSIC-DOM', '6']... (showing first 3 cells)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 9: ['JAMESON', 'IRISH-BLND', '7']... (showing first 3 cells)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: 2 non-empty cells
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: 6 non-empty cells
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: 9 non-empty cells
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: 9 non-empty cells
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: 9 non-empty cells
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Detected header row at index 2 (has 9 non-empty cells)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“ˆ Data rows: 100
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Table has 9 columns and 100 data rows
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Textract Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸŽ¯ Semantic Fields: ['brand (brand)', 'type (type)', 'ytd_rank (ytd_rank)', 'ytd_pct_total (ytd_pct_total)', 'ytd_case_sales (ytd_case_sales)', 'ytd_vs_last_year (ytd_vs_last_year)', 'current_month_case_sales (current_month_case_sales)', 'current_month_vs_last_year (current_month_vs_last_year)', 'l12m_case_sales (l12m_case_sales)']
2025-11-04 13:58:55 -0500 - dagster - WARNING - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 0 -> 'brand' (brand)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 1 -> 'type' (type)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 2 -> 'ytd_rank' (ytd_rank)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 3 -> 'ytd_pct_total' (ytd_pct_total)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 4 -> 'ytd_case_sales' (ytd_case_sales)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 5 -> 'ytd_vs_last_year' (ytd_vs_last_year)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 6 -> 'current_month_case_sales' (current_month_case_sales)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 7 -> 'current_month_vs_last_year' (current_month_vs_last_year)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 8 -> 'l12m_case_sales' (l12m_case_sales)
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š Column Mapping Complete: 9 of 9 columns mapped
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Mapping: {0: 'brand', 1: 'type', 2: 'ytd_rank', 3: 'ytd_pct_total', 4: 'ytd_case_sales', 5: 'ytd_vs_last_year', 6: 'current_month_case_sales', 7: 'current_month_vs_last_year', 8: 'l12m_case_sales'}
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 valid records
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“… Parsed date from '631_9L_0325.PDF': March 2025
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 records from artifact 0a7f9f31-17c6-42ef-bd71-4a9a6706a88b
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing artifact: de52568c-a384-42be-8231-7fe698c6a046
2025-11-04 13:58:55 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0425.PDF
2025-11-04 13:58:57 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracting pages 3-4...
2025-11-04 13:58:57 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - PDF has 740 pages, extracting pages 3-4
2025-11-04 13:58:57 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/de52568c-a384-42be-8231-7fe698c6a046/section.pdf
2025-11-04 13:58:57 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting Textract async analysis...
2025-11-04 13:58:57 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job started: d645f9e01a94827f6813ca61db1d0e5bd6922e43d3da8a8cb00e36fabef33a7a
2025-11-04 13:59:02 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 13:59:08 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job completed after 10s
2025-11-04 13:59:08 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieving all Textract blocks...
2025-11-04 13:59:08 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieved 3103 blocks from Textract
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract complete: 2 tables detected
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing 2 tables...
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 1: 53 rows
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 2: 53 rows
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Skipping 3 header rows, merging 50 data rows
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Merged table data: 103 total rows
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š RAW TABLE DATA (103 rows total):
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: ['ALL CONTROL STATES-APRIL', '2025', '']... (showing first 3 cells)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: ['', '', '']... (showing first 3 cells)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: ['BRAND', 'Type', 'Rank']... (showing first 3 cells)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: ['TITO HANDMADE', 'VODKA-CLASSIC-DOM', '1']... (showing first 3 cells)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: ['FIREBALL CINNMN', 'CAN-US BLND-US BTLD', '2']... (showing first 3 cells)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 5: ['J DNL BLACK LBL', 'DOM WHSKY-STRT-BRBN/TN', '3']... (showing first 3 cells)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 6: ['CPTMRG ORG SPCD', 'RUM-FLVRD', '4']... (showing first 3 cells)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 7: ['JIM BEAM', 'DOM WHSKY-STRT-BRBN/TN', '5']... (showing first 3 cells)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 8: ['PLATINUM 7X', 'VODKA-CLASSIC-DOM', '6']... (showing first 3 cells)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 9: ['JAMESON', 'IRISH-BLND', '7']... (showing first 3 cells)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: 2 non-empty cells
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: 6 non-empty cells
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: 9 non-empty cells
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: 9 non-empty cells
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: 9 non-empty cells
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Detected header row at index 2 (has 9 non-empty cells)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“ˆ Data rows: 100
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Table has 9 columns and 100 data rows
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Textract Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸŽ¯ Semantic Fields: ['brand (brand)', 'type (type)', 'ytd_rank (ytd_rank)', 'ytd_pct_total (ytd_pct_total)', 'ytd_case_sales (ytd_case_sales)', 'ytd_vs_last_year (ytd_vs_last_year)', 'current_month_case_sales (current_month_case_sales)', 'current_month_vs_last_year (current_month_vs_last_year)', 'l12m_case_sales (l12m_case_sales)']
2025-11-04 13:59:09 -0500 - dagster - WARNING - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 0 -> 'brand' (brand)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 1 -> 'type' (type)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 2 -> 'ytd_rank' (ytd_rank)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 3 -> 'ytd_pct_total' (ytd_pct_total)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 4 -> 'ytd_case_sales' (ytd_case_sales)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 5 -> 'ytd_vs_last_year' (ytd_vs_last_year)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 6 -> 'current_month_case_sales' (current_month_case_sales)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 7 -> 'current_month_vs_last_year' (current_month_vs_last_year)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 8 -> 'l12m_case_sales' (l12m_case_sales)
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š Column Mapping Complete: 9 of 9 columns mapped
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Mapping: {0: 'brand', 1: 'type', 2: 'ytd_rank', 3: 'ytd_pct_total', 4: 'ytd_case_sales', 5: 'ytd_vs_last_year', 6: 'current_month_case_sales', 7: 'current_month_vs_last_year', 8: 'l12m_case_sales'}
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 valid records
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“… Parsed date from '631_9L_0425.PDF': April 2025
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 records from artifact de52568c-a384-42be-8231-7fe698c6a046
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing artifact: bfaec311-e14e-406b-a80b-f27df5079652
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0525.PDF
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracting pages 3-4...
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - PDF has 752 pages, extracting pages 3-4
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/bfaec311-e14e-406b-a80b-f27df5079652/section.pdf
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting Textract async analysis...
2025-11-04 13:59:09 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job started: c7e3ad8b178b9db4f5b6cc73c5fa7f1cd2cd224b8660fc9421e655ca8624b168
2025-11-04 13:59:15 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 13:59:20 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job completed after 10s
2025-11-04 13:59:20 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieving all Textract blocks...
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieved 3099 blocks from Textract
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract complete: 2 tables detected
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing 2 tables...
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 1: 53 rows
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 2: 53 rows
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Skipping 3 header rows, merging 50 data rows
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Merged table data: 103 total rows
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š RAW TABLE DATA (103 rows total):
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: ['ALL CONTROL STATES-MAY', '2025', '']... (showing first 3 cells)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: ['', '', '']... (showing first 3 cells)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: ['BRAND', 'Type', 'Rank']... (showing first 3 cells)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: ['TITO HANDMADE', 'VODKA-CLASSIC-DOM', '1']... (showing first 3 cells)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: ['J DNL BLACK LBL', 'DOM WHSKY-STRT-BRBN/TN', '2']... (showing first 3 cells)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 5: ['FIREBALL CINNMN', 'CAN-US BLND-US BTLD', '3']... (showing first 3 cells)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 6: ['CPTMRG ORG SPCD', 'RUM-FLVRD', '4']... (showing first 3 cells)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 7: ['JIM BEAM', 'DOM WHSKY-STRT-BRBN/TN', '5']... (showing first 3 cells)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 8: ['PLATINUM 7X', 'VODKA-CLASSIC-DOM', '6']... (showing first 3 cells)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 9: ['JAMESON', 'IRISH-BLND', '7']... (showing first 3 cells)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: 2 non-empty cells
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: 6 non-empty cells
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: 9 non-empty cells
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: 9 non-empty cells
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: 9 non-empty cells
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Detected header row at index 2 (has 9 non-empty cells)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or - Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“ˆ Data rows: 100
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Table has 9 columns and 100 data rows
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Textract Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or - Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸŽ¯ Semantic Fields: ['brand (brand)', 'type (type)', 'ytd_rank (ytd_rank)', 'ytd_pct_total (ytd_pct_total)', 'ytd_case_sales (ytd_case_sales)', 'ytd_vs_last_year (ytd_vs_last_year)', 'current_month_case_sales (current_month_case_sales)', 'current_month_vs_last_year (current_month_vs_last_year)', 'l12m_case_sales (l12m_case_sales)']
2025-11-04 13:59:21 -0500 - dagster - WARNING - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or - Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 0 -> 'brand' (brand)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 1 -> 'type' (type)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 2 -> 'ytd_rank' (ytd_rank)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 3 -> 'ytd_pct_total' (ytd_pct_total)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 4 -> 'ytd_case_sales' (ytd_case_sales)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 5 -> 'ytd_vs_last_year' (ytd_vs_last_year)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 6 -> 'current_month_case_sales' (current_month_case_sales)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 7 -> 'current_month_vs_last_year' (current_month_vs_last_year)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 8 -> 'l12m_case_sales' (l12m_case_sales)
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š Column Mapping Complete: 9 of 9 columns mapped
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Mapping: {0: 'brand', 1: 'type', 2: 'ytd_rank', 3: 'ytd_pct_total', 4: 'ytd_case_sales', 5: 'ytd_vs_last_year', 6: 'current_month_case_sales', 7: 'current_month_vs_last_year', 8: 'l12m_case_sales'}
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 valid records
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“… Parsed date from '631_9L_0525.PDF': May 2025
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 records from artifact bfaec311-e14e-406b-a80b-f27df5079652
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing artifact: d96cc16b-2f4f-4bfd-819b-9319aede5b5a
2025-11-04 13:59:21 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0625.PDF
2025-11-04 13:59:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracting pages 3-4...
2025-11-04 13:59:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - PDF has 756 pages, extracting pages 3-4
2025-11-04 13:59:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/d96cc16b-2f4f-4bfd-819b-9319aede5b5a/section.pdf
2025-11-04 13:59:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting Textract async analysis...
2025-11-04 13:59:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job started: 1e3f07601b7675c4e57c0b6768bb4205bdb587bafd4364957627e68948762f62
2025-11-04 13:59:28 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 13:59:33 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job completed after 10s
2025-11-04 13:59:33 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieving all Textract blocks...
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieved 3111 blocks from Textract
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract complete: 2 tables detected
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing 2 tables...
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 1: 53 rows
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 2: 53 rows
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Skipping 3 header rows, merging 50 data rows
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Merged table data: 103 total rows
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š RAW TABLE DATA (103 rows total):
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: ['ALL CONTROL STATES-JUNE', '2025', '']... (showing first 3 cells)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: ['', '', '']... (showing first 3 cells)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: ['BRAND', 'Type', 'Rank']... (showing first 3 cells)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: ['TITO HANDMADE', 'VODKA-CLASSIC-DOM', '1']... (showing first 3 cells)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: ['J DNL BLACK LBL', 'DOM WHSKY-STRT-BRBN/TN', '2']... (showing first 3 cells)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 5: ['FIREBALL CINNMN', 'CAN-US BLND-US BTLD', '3']... (showing first 3 cells)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 6: ['CPTMRG ORG SPCD', 'RUM-FLVRD', '4']... (showing first 3 cells)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 7: ['JIM BEAM', 'DOM WHSKY-STRT-BRBN/TN', '5']... (showing first 3 cells)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 8: ['PLATINUM 7X', 'VODKA-CLASSIC-DOM', '6']... (showing first 3 cells)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 9: ['JAMESON', 'IRISH-BLND', '7']... (showing first 3 cells)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: 2 non-empty cells
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: 6 non-empty cells
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: 9 non-empty cells
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: 9 non-empty cells
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: 9 non-empty cells
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Detected header row at index 2 (has 9 non-empty cells)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“ˆ Data rows: 100
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Table has 9 columns and 100 data rows
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Textract Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸŽ¯ Semantic Fields: ['brand (brand)', 'type (type)', 'ytd_rank (ytd_rank)', 'ytd_pct_total (ytd_pct_total)', 'ytd_case_sales (ytd_case_sales)', 'ytd_vs_last_year (ytd_vs_last_year)', 'current_month_case_sales (current_month_case_sales)', 'current_month_vs_last_year (current_month_vs_last_year)', 'l12m_case_sales (l12m_case_sales)']
2025-11-04 13:59:34 -0500 - dagster - WARNING - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 0 -> 'brand' (brand)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 1 -> 'type' (type)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 2 -> 'ytd_rank' (ytd_rank)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 3 -> 'ytd_pct_total' (ytd_pct_total)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 4 -> 'ytd_case_sales' (ytd_case_sales)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 5 -> 'ytd_vs_last_year' (ytd_vs_last_year)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 6 -> 'current_month_case_sales' (current_month_case_sales)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 7 -> 'current_month_vs_last_year' (current_month_vs_last_year)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 8 -> 'l12m_case_sales' (l12m_case_sales)
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š Column Mapping Complete: 9 of 9 columns mapped
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Mapping: {0: 'brand', 1: 'type', 2: 'ytd_rank', 3: 'ytd_pct_total', 4: 'ytd_case_sales', 5: 'ytd_vs_last_year', 6: 'current_month_case_sales', 7: 'current_month_vs_last_year', 8: 'l12m_case_sales'}
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 valid records
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“… Parsed date from '631_9L_0625.PDF': June 2025
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 records from artifact d96cc16b-2f4f-4bfd-819b-9319aede5b5a
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing artifact: 5062bfca-0f07-456f-8f8a-08b07c8549fa
2025-11-04 13:59:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0724.PDF
2025-11-04 13:59:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracting pages 3-4...
2025-11-04 13:59:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - PDF has 726 pages, extracting pages 3-4
2025-11-04 13:59:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/5062bfca-0f07-456f-8f8a-08b07c8549fa/section.pdf
2025-11-04 13:59:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting Textract async analysis...
2025-11-04 13:59:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job started: 2b3836be2fe0e2f9e90c42dc8321b12e85185d33e2cca6aecc1acf94358fd600
2025-11-04 13:59:40 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 13:59:45 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job completed after 10s
2025-11-04 13:59:45 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieving all Textract blocks...
2025-11-04 13:59:46 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieved 3098 blocks from Textract
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract complete: 2 tables detected
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing 2 tables...
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 1: 53 rows
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 2: 53 rows
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Skipping 3 header rows, merging 50 data rows
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Merged table data: 103 total rows
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š RAW TABLE DATA (103 rows total):
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: ['ALL CONTROL STATES-JULY', '2024', '']... (showing first 3 cells)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: ['', '', '']... (showing first 3 cells)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: ['BRAND', 'Type', 'Rank']... (showing first 3 cells)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: ['TITO HANDMADE', 'VODKA-CLASSIC-DOM', '1']... (showing first 3 cells)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: ['FIREBALL CINNMN', 'CAN-US BLND-US BTLD', '2']... (showing first 3 cells)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 5: ['J DNL BLACK LBL', 'DOM WHSKY-STRT-BRBN/TN', '3']... (showing first 3 cells)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 6: ['CPTMRG ORG SPCD', 'RUM-FLVRD', '4']... (showing first 3 cells)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 7: ['JIM BEAM', 'DOM WHSKY-STRT-BRBN/TN', '5']... (showing first 3 cells)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 8: ['PLATINUM 7X', 'VODKA-CLASSIC-DOM', '6']... (showing first 3 cells)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 9: ['BAC SUPERIOR', 'RUM-LIGHT', '7']... (showing first 3 cells)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: 2 non-empty cells
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: 6 non-empty cells
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: 9 non-empty cells
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: 9 non-empty cells
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: 9 non-empty cells
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Detected header row at index 2 (has 9 non-empty cells)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“ˆ Data rows: 100
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Table has 9 columns and 100 data rows
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Textract Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸŽ¯ Semantic Fields: ['brand (brand)', 'type (type)', 'ytd_rank (ytd_rank)', 'ytd_pct_total (ytd_pct_total)', 'ytd_case_sales (ytd_case_sales)', 'ytd_vs_last_year (ytd_vs_last_year)', 'current_month_case_sales (current_month_case_sales)', 'current_month_vs_last_year (current_month_vs_last_year)', 'l12m_case_sales (l12m_case_sales)']
2025-11-04 13:59:47 -0500 - dagster - WARNING - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 0 -> 'brand' (brand)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 1 -> 'type' (type)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 2 -> 'ytd_rank' (ytd_rank)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 3 -> 'ytd_pct_total' (ytd_pct_total)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 4 -> 'ytd_case_sales' (ytd_case_sales)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 5 -> 'ytd_vs_last_year' (ytd_vs_last_year)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 6 -> 'current_month_case_sales' (current_month_case_sales)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 7 -> 'current_month_vs_last_year' (current_month_vs_last_year)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 8 -> 'l12m_case_sales' (l12m_case_sales)
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š Column Mapping Complete: 9 of 9 columns mapped
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Mapping: {0: 'brand', 1: 'type', 2: 'ytd_rank', 3: 'ytd_pct_total', 4: 'ytd_case_sales', 5: 'ytd_vs_last_year', 6: 'current_month_case_sales', 7: 'current_month_vs_last_year', 8: 'l12m_case_sales'}
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 valid records
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“… Parsed date from '631_9L_0724.PDF': July 2024
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 records from artifact 5062bfca-0f07-456f-8f8a-08b07c8549fa
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing artifact: 5c21d408-8558-46af-a313-d0c34ea32bfc
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0725.PDF
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracting pages 3-4...
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - PDF has 762 pages, extracting pages 3-4
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/5c21d408-8558-46af-a313-d0c34ea32bfc/section.pdf
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting Textract async analysis...
2025-11-04 13:59:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job started: bdb7fbc726698e7cc69088543cd81feddc15af03c85959a63329e3f858b7afc6
2025-11-04 13:59:52 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job completed after 10s
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieving all Textract blocks...
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieved 3101 blocks from Textract
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract complete: 2 tables detected
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing 2 tables...
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 1: 53 rows
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 2: 53 rows
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Skipping 3 header rows, merging 50 data rows
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Merged table data: 103 total rows
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š RAW TABLE DATA (103 rows total):
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: ['ALL CONTROL STATES-JULY', '2025', '']... (showing first 3 cells)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: ['', '', '']... (showing first 3 cells)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: ['BRAND', 'Type', 'Rank']... (showing first 3 cells)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: ['TITO HANDMADE', 'VODKA-CLASSIC-DOM', '1']... (showing first 3 cells)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: ['J DNL BLACK LBL', 'DOM WHSKY-STRT-BRBN/TN', '2']... (showing first 3 cells)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 5: ['FIREBALL CINNMN', 'CAN-US BLND-US BTLD', '3']... (showing first 3 cells)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 6: ['CPTMRG ORG SPCD', 'RUM-FLVRD', '4']... (showing first 3 cells)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 7: ['JIM BEAM', 'DOM WHSKY-STRT-BRBN/TN', '5']... (showing first 3 cells)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 8: ['PLATINUM 7X', 'VODKA-CLASSIC-DOM', '6']... (showing first 3 cells)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 9: ['BAC SUPERIOR', 'RUM-LIGHT', '7']... (showing first 3 cells)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: 2 non-empty cells
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: 6 non-empty cells
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: 9 non-empty cells
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: 9 non-empty cells
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: 9 non-empty cells
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Detected header row at index 2 (has 9 non-empty cells)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“ˆ Data rows: 100
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Table has 9 columns and 100 data rows
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Textract Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸŽ¯ Semantic Fields: ['brand (brand)', 'type (type)', 'ytd_rank (ytd_rank)', 'ytd_pct_total (ytd_pct_total)', 'ytd_case_sales (ytd_case_sales)', 'ytd_vs_last_year (ytd_vs_last_year)', 'current_month_case_sales (current_month_case_sales)', 'current_month_vs_last_year (current_month_vs_last_year)', 'l12m_case_sales (l12m_case_sales)']
2025-11-04 13:59:58 -0500 - dagster - WARNING - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 0 -> 'brand' (brand)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 1 -> 'type' (type)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 2 -> 'ytd_rank' (ytd_rank)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 3 -> 'ytd_pct_total' (ytd_pct_total)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 4 -> 'ytd_case_sales' (ytd_case_sales)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 5 -> 'ytd_vs_last_year' (ytd_vs_last_year)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 6 -> 'current_month_case_sales' (current_month_case_sales)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 7 -> 'current_month_vs_last_year' (current_month_vs_last_year)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 8 -> 'l12m_case_sales' (l12m_case_sales)
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š Column Mapping Complete: 9 of 9 columns mapped
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Mapping: {0: 'brand', 1: 'type', 2: 'ytd_rank', 3: 'ytd_pct_total', 4: 'ytd_case_sales', 5: 'ytd_vs_last_year', 6: 'current_month_case_sales', 7: 'current_month_vs_last_year', 8: 'l12m_case_sales'}
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 valid records
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“… Parsed date from '631_9L_0725.PDF': July 2025
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 records from artifact 5c21d408-8558-46af-a313-d0c34ea32bfc
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing artifact: 3b066d2f-b4ba-48a9-8b2a-4abfc6a39184
2025-11-04 13:59:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0824.PDF
2025-11-04 13:59:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracting pages 3-4...
2025-11-04 13:59:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - PDF has 736 pages, extracting pages 3-4
2025-11-04 13:59:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/3b066d2f-b4ba-48a9-8b2a-4abfc6a39184/section.pdf
2025-11-04 13:59:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting Textract async analysis...
2025-11-04 13:59:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job started: 54ab37e731fa146f60751be5ab1baa8925534693121f5797490f07d01ba1676f
2025-11-04 14:00:04 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:00:10 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job completed after 10s
2025-11-04 14:00:10 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieving all Textract blocks...
2025-11-04 14:00:10 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieved 3115 blocks from Textract
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract complete: 2 tables detected
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing 2 tables...
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 1: 53 rows
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 2: 53 rows
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Skipping 3 header rows, merging 50 data rows
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Merged table data: 103 total rows
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š RAW TABLE DATA (103 rows total):
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: ['ALL CONTROL STATES-AUGUST', '2024', '']... (showing first 3 cells)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: ['', '', '']... (showing first 3 cells)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: ['BRAND', 'Type', 'Rank']... (showing first 3 cells)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: ['TITO HANDMADE', 'VODKA-CLASSIC-DOM', '1']... (showing first 3 cells)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: ['FIREBALL CINNMN', 'CAN-US BLND-US BTLD', '2']... (showing first 3 cells)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 5: ['J DNL BLACK LBL', 'DOM WHSKY-STRT-BRBN/TN', '3']... (showing first 3 cells)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 6: ['CPTMRG ORG SPCD', 'RUM-FLVRD', '4']... (showing first 3 cells)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 7: ['JIM BEAM', 'DOM WHSKY-STRT-BRBN/TN', '5']... (showing first 3 cells)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 8: ['PLATINUM 7X', 'VODKA-CLASSIC-DOM', '6']... (showing first 3 cells)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 9: ['BAC SUPERIOR', 'RUM-LIGHT', '7']... (showing first 3 cells)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: 2 non-empty cells
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: 6 non-empty cells
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: 9 non-empty cells
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: 9 non-empty cells
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: 9 non-empty cells
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Detected header row at index 2 (has 9 non-empty cells)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“ˆ Data rows: 100
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Table has 9 columns and 100 data rows
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Textract Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸŽ¯ Semantic Fields: ['brand (brand)', 'type (type)', 'ytd_rank (ytd_rank)', 'ytd_pct_total (ytd_pct_total)', 'ytd_case_sales (ytd_case_sales)', 'ytd_vs_last_year (ytd_vs_last_year)', 'current_month_case_sales (current_month_case_sales)', 'current_month_vs_last_year (current_month_vs_last_year)', 'l12m_case_sales (l12m_case_sales)']
2025-11-04 14:00:11 -0500 - dagster - WARNING - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 0 -> 'brand' (brand)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 1 -> 'type' (type)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 2 -> 'ytd_rank' (ytd_rank)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 3 -> 'ytd_pct_total' (ytd_pct_total)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 4 -> 'ytd_case_sales' (ytd_case_sales)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 5 -> 'ytd_vs_last_year' (ytd_vs_last_year)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 6 -> 'current_month_case_sales' (current_month_case_sales)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 7 -> 'current_month_vs_last_year' (current_month_vs_last_year)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 8 -> 'l12m_case_sales' (l12m_case_sales)
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š Column Mapping Complete: 9 of 9 columns mapped
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Mapping: {0: 'brand', 1: 'type', 2: 'ytd_rank', 3: 'ytd_pct_total', 4: 'ytd_case_sales', 5: 'ytd_vs_last_year', 6: 'current_month_case_sales', 7: 'current_month_vs_last_year', 8: 'l12m_case_sales'}
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 valid records
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“… Parsed date from '631_9L_0824.PDF': August 2024
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 records from artifact 3b066d2f-b4ba-48a9-8b2a-4abfc6a39184
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing artifact: 0f2c48bb-830e-4bf4-94fc-0fde43277c08
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_0924.PDF
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracting pages 3-4...
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - PDF has 740 pages, extracting pages 3-4
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/0f2c48bb-830e-4bf4-94fc-0fde43277c08/section.pdf
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting Textract async analysis...
2025-11-04 14:00:11 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job started: 9c9d107955d5f517b5dcebf52c687f07a4de77a8112158e480348c7046bc29df
2025-11-04 14:00:16 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:00:22 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job completed after 10s
2025-11-04 14:00:22 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieving all Textract blocks...
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieved 3100 blocks from Textract
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract complete: 2 tables detected
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing 2 tables...
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 1: 53 rows
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 2: 53 rows
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Skipping 3 header rows, merging 50 data rows
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Merged table data: 103 total rows
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š RAW TABLE DATA (103 rows total):
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: ['ALL CONTROL STATES-SEPTEMBER', '2024', '']... (showing first 3 cells)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: ['', '', '']... (showing first 3 cells)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: ['BRAND', 'Type', 'Rank']... (showing first 3 cells)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: ['TITO HANDMADE', 'VODKA-CLASSIC-DOM', '1']... (showing first 3 cells)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: ['FIREBALL CINNMN', 'CAN-US BLND-US BTLD', '2']... (showing first 3 cells)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 5: ['J DNL BLACK LBL', 'DOM WHSKY-STRT-BRBN/TN', '3']... (showing first 3 cells)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 6: ['CPTMRG ORG SPCD', 'RUM-FLVRD', '4']... (showing first 3 cells)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 7: ['JIM BEAM', 'DOM WHSKY-STRT-BRBN/TN', '5']... (showing first 3 cells)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 8: ['PLATINUM 7X', 'VODKA-CLASSIC-DOM', '6']... (showing first 3 cells)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 9: ['BAC SUPERIOR', 'RUM-LIGHT', '7']... (showing first 3 cells)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: 2 non-empty cells
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: 6 non-empty cells
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: 9 non-empty cells
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: 9 non-empty cells
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: 9 non-empty cells
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Detected header row at index 2 (has 9 non-empty cells)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“ˆ Data rows: 100
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Table has 9 columns and 100 data rows
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Textract Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸŽ¯ Semantic Fields: ['brand (brand)', 'type (type)', 'ytd_rank (ytd_rank)', 'ytd_pct_total (ytd_pct_total)', 'ytd_case_sales (ytd_case_sales)', 'ytd_vs_last_year (ytd_vs_last_year)', 'current_month_case_sales (current_month_case_sales)', 'current_month_vs_last_year (current_month_vs_last_year)', 'l12m_case_sales (l12m_case_sales)']
2025-11-04 14:00:23 -0500 - dagster - WARNING - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 0 -> 'brand' (brand)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 1 -> 'type' (type)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 2 -> 'ytd_rank' (ytd_rank)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 3 -> 'ytd_pct_total' (ytd_pct_total)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 4 -> 'ytd_case_sales' (ytd_case_sales)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 5 -> 'ytd_vs_last_year' (ytd_vs_last_year)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 6 -> 'current_month_case_sales' (current_month_case_sales)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 7 -> 'current_month_vs_last_year' (current_month_vs_last_year)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 8 -> 'l12m_case_sales' (l12m_case_sales)
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š Column Mapping Complete: 9 of 9 columns mapped
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Mapping: {0: 'brand', 1: 'type', 2: 'ytd_rank', 3: 'ytd_pct_total', 4: 'ytd_case_sales', 5: 'ytd_vs_last_year', 6: 'current_month_case_sales', 7: 'current_month_vs_last_year', 8: 'l12m_case_sales'}
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 valid records
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“… Parsed date from '631_9L_0924.PDF': September 2024
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 records from artifact 0f2c48bb-830e-4bf4-94fc-0fde43277c08
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing artifact: 386391b7-c87b-415b-a33e-0b3f30ff10c6
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_1024.PDF
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracting pages 3-4...
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - PDF has 752 pages, extracting pages 3-4
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/386391b7-c87b-415b-a33e-0b3f30ff10c6/section.pdf
2025-11-04 14:00:23 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting Textract async analysis...
2025-11-04 14:00:24 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job started: fb5c352384b125335cde0df9c8f1a41b97b2e0e60e3b4628be4bbd94982bfcf3
2025-11-04 14:00:29 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:00:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job completed after 10s
2025-11-04 14:00:34 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieving all Textract blocks...
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieved 3098 blocks from Textract
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract complete: 2 tables detected
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing 2 tables...
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 1: 53 rows
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 2: 53 rows
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Skipping 3 header rows, merging 50 data rows
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Merged table data: 103 total rows
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š RAW TABLE DATA (103 rows total):
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: ['ALL CONTROL STATES-OCTOBER', '2024', '']... (showing first 3 cells)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: ['', '', '']... (showing first 3 cells)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: ['BRAND', 'Type', 'Rank']... (showing first 3 cells)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: ['TITO HANDMADE', 'VODKA-CLASSIC-DOM', '1']... (showing first 3 cells)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: ['FIREBALL CINNMN', 'CAN-US BLND-US BTLD', '2']... (showing first 3 cells)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 5: ['J DNL BLACK LBL', 'DOM WHSKY-STRT-BRBN/TN', '3']... (showing first 3 cells)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 6: ['CPTMRG ORG SPCD', 'RUM-FLVRD', '4']... (showing first 3 cells)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 7: ['JIM BEAM', 'DOM WHSKY-STRT-BRBN/TN', '5']... (showing first 3 cells)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 8: ['PLATINUM 7X', 'VODKA-CLASSIC-DOM', '6']... (showing first 3 cells)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 9: ['BAC SUPERIOR', 'RUM-LIGHT', '7']... (showing first 3 cells)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: 2 non-empty cells
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: 5 non-empty cells
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: 9 non-empty cells
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: 9 non-empty cells
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: 9 non-empty cells
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Detected header row at index 2 (has 9 non-empty cells)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“ˆ Data rows: 100
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Table has 9 columns and 100 data rows
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Textract Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸŽ¯ Semantic Fields: ['brand (brand)', 'type (type)', 'ytd_rank (ytd_rank)', 'ytd_pct_total (ytd_pct_total)', 'ytd_case_sales (ytd_case_sales)', 'ytd_vs_last_year (ytd_vs_last_year)', 'current_month_case_sales (current_month_case_sales)', 'current_month_vs_last_year (current_month_vs_last_year)', 'l12m_case_sales (l12m_case_sales)']
2025-11-04 14:00:35 -0500 - dagster - WARNING - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 0 -> 'brand' (brand)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 1 -> 'type' (type)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 2 -> 'ytd_rank' (ytd_rank)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 3 -> 'ytd_pct_total' (ytd_pct_total)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 4 -> 'ytd_case_sales' (ytd_case_sales)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 5 -> 'ytd_vs_last_year' (ytd_vs_last_year)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 6 -> 'current_month_case_sales' (current_month_case_sales)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 7 -> 'current_month_vs_last_year' (current_month_vs_last_year)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 8 -> 'l12m_case_sales' (l12m_case_sales)
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š Column Mapping Complete: 9 of 9 columns mapped
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Mapping: {0: 'brand', 1: 'type', 2: 'ytd_rank', 3: 'ytd_pct_total', 4: 'ytd_case_sales', 5: 'ytd_vs_last_year', 6: 'current_month_case_sales', 7: 'current_month_vs_last_year', 8: 'l12m_case_sales'}
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 valid records
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“… Parsed date from '631_9L_1024.PDF': October 2024
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 records from artifact 386391b7-c87b-415b-a33e-0b3f30ff10c6
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing artifact: 015aad82-ac64-4ab3-bb60-134d8723fea5
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_1124.PDF
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracting pages 3-4...
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - PDF has 758 pages, extracting pages 3-4
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/015aad82-ac64-4ab3-bb60-134d8723fea5/section.pdf
2025-11-04 14:00:35 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting Textract async analysis...
2025-11-04 14:00:36 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job started: 0a09e4d82340a881b273cbfbd45802de576d78f9fc965c77e092645c82718841
2025-11-04 14:00:41 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:00:46 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job completed after 10s
2025-11-04 14:00:46 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieving all Textract blocks...
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieved 3101 blocks from Textract
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract complete: 2 tables detected
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing 2 tables...
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 1: 53 rows
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 2: 53 rows
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Skipping 3 header rows, merging 50 data rows
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Merged table data: 103 total rows
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š RAW TABLE DATA (103 rows total):
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: ['ALL CONTROL STATES-NOVEMBER', '2024', '']... (showing first 3 cells)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: ['', '', '']... (showing first 3 cells)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: ['BRAND', 'Type', 'Rank']... (showing first 3 cells)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: ['TITO HANDMADE', 'VODKA-CLASSIC-DOM', '1']... (showing first 3 cells)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: ['FIREBALL CINNMN', 'CAN-US BLND-US BTLD', '2']... (showing first 3 cells)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 5: ['J DNL BLACK LBL', 'DOM WHSKY-STRT-BRBN/TN', '3']... (showing first 3 cells)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 6: ['CPTMRG ORG SPCD', 'RUM-FLVRD', '4']... (showing first 3 cells)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 7: ['JIM BEAM', 'DOM WHSKY-STRT-BRBN/TN', '5']... (showing first 3 cells)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 8: ['PLATINUM 7X', 'VODKA-CLASSIC-DOM', '6']... (showing first 3 cells)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 9: ['BAC SUPERIOR', 'RUM-LIGHT', '7']... (showing first 3 cells)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: 2 non-empty cells
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: 6 non-empty cells
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: 9 non-empty cells
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: 9 non-empty cells
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: 9 non-empty cells
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Detected header row at index 2 (has 9 non-empty cells)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“ˆ Data rows: 100
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Table has 9 columns and 100 data rows
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Textract Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸŽ¯ Semantic Fields: ['brand (brand)', 'type (type)', 'ytd_rank (ytd_rank)', 'ytd_pct_total (ytd_pct_total)', 'ytd_case_sales (ytd_case_sales)', 'ytd_vs_last_year (ytd_vs_last_year)', 'current_month_case_sales (current_month_case_sales)', 'current_month_vs_last_year (current_month_vs_last_year)', 'l12m_case_sales (l12m_case_sales)']
2025-11-04 14:00:47 -0500 - dagster - WARNING - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 0 -> 'brand' (brand)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 1 -> 'type' (type)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 2 -> 'ytd_rank' (ytd_rank)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 3 -> 'ytd_pct_total' (ytd_pct_total)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 4 -> 'ytd_case_sales' (ytd_case_sales)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 5 -> 'ytd_vs_last_year' (ytd_vs_last_year)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 6 -> 'current_month_case_sales' (current_month_case_sales)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 7 -> 'current_month_vs_last_year' (current_month_vs_last_year)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 8 -> 'l12m_case_sales' (l12m_case_sales)
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š Column Mapping Complete: 9 of 9 columns mapped
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Mapping: {0: 'brand', 1: 'type', 2: 'ytd_rank', 3: 'ytd_pct_total', 4: 'ytd_case_sales', 5: 'ytd_vs_last_year', 6: 'current_month_case_sales', 7: 'current_month_vs_last_year', 8: 'l12m_case_sales'}
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 valid records
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“… Parsed date from '631_9L_1124.PDF': November 2024
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 records from artifact 015aad82-ac64-4ab3-bb60-134d8723fea5
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing artifact: fb4f08e3-1f73-45e0-9e53-761b167d8555
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Downloading from S3: s3://nabca-data/raw-pdfs/631_9L_1224.PDF
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracting pages 3-4...
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - PDF has 766 pages, extracting pages 3-4
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Uploading to S3: s3://inspector-dom-textract/textract-temp/nabca-extraction/fb4f08e3-1f73-45e0-9e53-761b167d8555/section.pdf
2025-11-04 14:00:47 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Starting Textract async analysis...
2025-11-04 14:00:48 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job started: 26dd247c20d11aa7ba1eefd208b9767a4ff8bbac4cc0603f1390b50a0f5364e3
2025-11-04 14:00:53 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job status: IN_PROGRESS (waited 5s)
2025-11-04 14:00:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract job completed after 10s
2025-11-04 14:00:58 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieving all Textract blocks...
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Retrieved 3101 blocks from Textract
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Textract complete: 2 tables detected
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Processing 2 tables...
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 1: 53 rows
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Table 2: 53 rows
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Skipping 3 header rows, merging 50 data rows
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Merged table data: 103 total rows
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š RAW TABLE DATA (103 rows total):
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: ['ALL CONTROL STATES-DECEMBER', '2024', '']... (showing first 3 cells)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: ['', '', '']... (showing first 3 cells)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: ['BRAND', 'Type', 'Rank']... (showing first 3 cells)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: ['TITO HANDMADE', 'VODKA-CLASSIC-DOM', '1']... (showing first 3 cells)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: ['FIREBALL CINNMN', 'CAN-US BLND-US BTLD', '2']... (showing first 3 cells)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 5: ['J DNL BLACK LBL', 'DOM WHSKY-STRT-BRBN/TN', '3']... (showing first 3 cells)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 6: ['CPTMRG ORG SPCD', 'RUM-FLVRD', '4']... (showing first 3 cells)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 7: ['JIM BEAM', 'DOM WHSKY-STRT-BRBN/TN', '5']... (showing first 3 cells)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 8: ['PLATINUM 7X', 'VODKA-CLASSIC-DOM', '6']... (showing first 3 cells)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 9: ['BAC SUPERIOR', 'RUM-LIGHT', '7']... (showing first 3 cells)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 0: 2 non-empty cells
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 1: 6 non-empty cells
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 2: 9 non-empty cells
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 3: 9 non-empty cells
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -   Row 4: 9 non-empty cells
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Detected header row at index 2 (has 9 non-empty cells)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“ˆ Data rows: 100
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Table has 9 columns and 100 data rows
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“‹ Textract Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸŽ¯ Semantic Fields: ['brand (brand)', 'type (type)', 'ytd_rank (ytd_rank)', 'ytd_pct_total (ytd_pct_total)', 'ytd_case_sales (ytd_case_sales)', 'ytd_vs_last_year (ytd_vs_last_year)', 'current_month_case_sales (current_month_case_sales)', 'current_month_vs_last_year (current_month_vs_last_year)', 'l12m_case_sales (l12m_case_sales)']
2025-11-04 14:00:59 -0500 - dagster - WARNING - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âš ï¸  Duplicate headers detected! Using positional mapping.
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 -     Headers: ['BRAND', 'Type', 'Rank', '% Total', 'Case Sales', '+ or Last Year', 'Case Sales', '+ or Last Year', 'Case Sales Last Twelve Months']
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 0 -> 'brand' (brand)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 1 -> 'type' (type)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 2 -> 'ytd_rank' (ytd_rank)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 3 -> 'ytd_pct_total' (ytd_pct_total)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 4 -> 'ytd_case_sales' (ytd_case_sales)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 5 -> 'ytd_vs_last_year' (ytd_vs_last_year)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 6 -> 'current_month_case_sales' (current_month_case_sales)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 7 -> 'current_month_vs_last_year' (current_month_vs_last_year)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - âœ… Positional mapping: column 8 -> 'l12m_case_sales' (l12m_case_sales)
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“Š Column Mapping Complete: 9 of 9 columns mapped
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Mapping: {0: 'brand', 1: 'type', 2: 'ytd_rank', 3: 'ytd_pct_total', 4: 'ytd_case_sales', 5: 'ytd_vs_last_year', 6: 'current_month_case_sales', 7: 'current_month_vs_last_year', 8: 'l12m_case_sales'}
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 valid records
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - ðŸ“… Parsed date from '631_9L_1224.PDF': December 2024
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Extracted 100 records from artifact fb4f08e3-1f73-45e0-9e53-761b167d8555
2025-11-04 14:00:59 -0500 - dagster - INFO - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - NABCA extraction complete: 1300 records from 13 artifacts, 0 failed (100.0% success rate)
2025-11-04 14:00:59 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - 74639 - extract_raw_nabca_table_1 - STEP_OUTPUT - Yielded output "result" of type "Dict[String,Any]". (Type check passed).
2025-11-04 14:00:59 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - extract_raw_nabca_table_1 - Writing file at: /Users/ashraykenguntejayachandra/claude-workspace/claude-sandbox/ins-dom/dagster_home/storage/extract_raw_nabca_table_1 using PickledObjectFilesystemIOManager...
2025-11-04 14:00:59 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - 74639 - extract_raw_nabca_table_1 - ASSET_MATERIALIZATION - Materialized value extract_raw_nabca_table_1.
2025-11-04 14:00:59 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - 74639 - extract_raw_nabca_table_1 - HANDLED_OUTPUT - Handled output "result" using IO manager "io_manager"
2025-11-04 14:00:59 -0500 - dagster - DEBUG - __ASSET_JOB - cfe5511c-f8ea-409d-b6a2-03f04eb2e639 - 74639 - extract_raw_nabca_table_1 - STEP_SUCCESS - Finished execution of step "extract_raw_nabca_table_1" in 2m45s.
